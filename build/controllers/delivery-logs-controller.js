"use strict";var c=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var w=(t,e)=>{for(var s in e)c(t,s,{get:e[s],enumerable:!0})},v=(t,e,s,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of h(e))!y.call(t,r)&&r!==s&&c(t,r,{get:()=>e[r],enumerable:!(o=l(e,r))||o.enumerable});return t};var f=t=>v(c({},"__esModule",{value:!0}),t);var g={};w(g,{DeliveryLogsController:()=>p});module.exports=f(g);var i=class{message;statusCode;constructor(e,s=400){this.message=e,this.statusCode=s}};var m=require("@prisma/client"),a=new m.PrismaClient({log:process.env.NODE_ENV==="production"?[]:["query"]});var n=require("zod"),p=class{async create(e,s){let o=n.z.object({delivery_id:n.z.string().uuid(),description:n.z.string()}),{delivery_id:r,description:d}=o.parse(e.body),u=await a.delivery.findUnique({where:{id:r}});if(!u)throw new i("delivery not found",404);if(u.status==="delivered")throw new i("this order has already been delivered");if(u.status==="processing")throw new i("change status to shipped");return await a.deliveryLog.create({data:{deliveryId:r,description:d}}),s.status(201).json()}async show(e,s){let o=n.z.object({delivery_id:n.z.string().uuid()}),{delivery_id:r}=o.parse(e.params),d=await a.delivery.findUnique({where:{id:r},include:{user:!0,logs:!0}});if(e.user?.role==="customer"&&e.user.id!==d?.userId)throw new i("the user can only view their deliveries",401);return s.json(d)}};0&&(module.exports={DeliveryLogsController});
//# sourceMappingURL=delivery-logs-controller.js.map