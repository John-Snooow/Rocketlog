"use strict";var a=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var g=Object.prototype.hasOwnProperty;var T=(t,e)=>{for(var o in e)a(t,o,{get:e[o],enumerable:!0})},l=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of h(e))!g.call(t,r)&&r!==o&&a(t,r,{get:()=>e[r],enumerable:!(n=d(e,r))||n.enumerable});return t};var R=t=>l(a({},"__esModule",{value:!0}),t);var v={};T(v,{ensureAuthenticated:()=>b});module.exports=R(v);var m=require("jsonwebtoken");var s=require("zod"),x=s.z.object({DATABASE_URL:s.z.string().url(),JWT_SECRET:s.z.string(),PORT:s.z.coerce.number().default(3333)}),u=x.parse(process.env);var c={jwt:{secret:u.JWT_SECRET,expiresIn:"1d"}};var i=class{message;statusCode;constructor(e,o=400){this.message=e,this.statusCode=o}};function b(t,e,o){try{let n=t.headers.authorization;if(!n)throw new i("JWT token not found",401);let[,r]=n.split(" "),{role:p,sub:f}=(0,m.verify)(r,c.jwt.secret);return t.user={id:f,role:p},o()}catch{throw new i("Invalid JWT token",401)}}0&&(module.exports={ensureAuthenticated});
//# sourceMappingURL=ensure-authenticated.js.map